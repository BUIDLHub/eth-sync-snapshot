{"version":3,"sources":["../src/SnapPuller.js"],"names":["yup","log","Logger","component","schema","object","snapshotId","string","required","BASE_URL","SnapPuller","props","validateSync","url","forEach","fn","bind","method","responseType","then","stream","PassThrough","resp","data","pipe","catch","error","e"],"mappings":";;;;;;;;AAAA;;;;AACA;;IAAYA,G;;AACZ;;;;AACA;;;;;;;;;;AAEA,IAAMC,MAAM,IAAIC,gBAAJ,CAAW,EAACC,WAAW,YAAZ,EAAX,CAAZ;;AAEA,IAAMC,SAASJ,IAAIK,MAAJ,CAAW;AACxBC,cAAYN,IAAIO,MAAJ,GAAaC,QAAb,CAAsB,+BAAtB;AADY,CAAX,CAAf;;AAIA,IAAMC,WAAW,mDAAjB;;IAEqBC,U;AACnB,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjBP,WAAOQ,YAAP,CAAoBD,KAApB;AACA,SAAKE,GAAL,GAAWJ,WAAWE,MAAML,UAA5B;AACA,KACE,UADF,EAEEQ,OAFF,CAEU;AAAA,aAAI,MAAKC,EAAL,IAAS,MAAKA,EAAL,EAASC,IAAT,CAAc,KAAd,CAAb;AAAA,KAFV;AAGD;;;;+BAEU;AACT,aAAO,qBAAM;AACXH,aAAK,KAAKA,GADC;AAEXI,gBAAQ,KAFG;AAGXC,sBAAc;AAHH,OAAN,EAIJC,IAJI,CAIC,gBAAM;AACZ,YAAIC,SAAS,IAAIA,OAAOC,WAAX,EAAb;AACAC,aAAKC,IAAL,CAAUC,IAAV,CAAeJ,MAAf;AACA,eAAOA,MAAP;AACD,OARM,EAQJK,KARI,CAQE,aAAG;AACVxB,YAAIyB,KAAJ,CAAU,2BAAV,EAAuCC,CAAvC;AACA,eAAO,IAAP;AACD,OAXM,CAAP;AAYD;;;;;;kBAtBkBjB,U","file":"SnapPuller.js","sourcesContent":["import axios from 'axios';\nimport * as yup from 'yup';\nimport stream from 'stream';\nimport Logger from './Logger';\n\nconst log = new Logger({component: \"SnapPuller\"});\n\nconst schema = yup.object({\n  snapshotId: yup.string().required(\"SnapPuller missing snapshotId\")\n});\n\nconst BASE_URL = \"https://buidlhub-snapshots.s3.amazonaws.com/snap_\";\n\nexport default class SnapPuller {\n  constructor(props) {\n    schema.validateSync(props);\n    this.url = BASE_URL + props.snapshotId;\n    [\n      'download'\n    ].forEach(fn=>this[fn]=this[fn].bind(this));\n  }\n\n  download() {\n    return axios({\n      url: this.url,\n      method: \"GET\",\n      responseType: \"stream\"\n    }).then(resp=>{\n      let stream = new stream.PassThrough();\n      resp.data.pipe(stream);\n      return stream;\n    }).catch(e=>{\n      log.error(\"Problem download snapshot\", e);\n      return null;\n    });\n  }\n}\n"]}